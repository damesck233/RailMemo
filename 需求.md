

# 项目需求文档

## 项目目标

本项目旨在为用户提供一个在线生成火车票的工具。用户可在网页输入相关信息，系统自动将用户输入内容替换到车票模板的对应占位符，最终生成一张可打印、可导出的电子火车票。

## 功能需求

1. **信息输入**
    - 用户可在页面表单中输入姓名、证件号码、车次、出发站、到达站、座位号、日期、发车时间、票价等信息。

2. **模板替换**
    - 使用 `模板.html` 作为车票基础模板，模板中包含若干占位符（如 `{name}`、`{train_no}` 等）。
    - 用户填写完表单后，系统将用户输入内容替换模板中的对应占位符，生成完整车票页面。

3. **车票预览**
    - 用户可实时预览生成的车票效果。

4. **打印与导出**
    - 用户可直接打印生成的车票。
    - 用户可将生成的车票导出为 PDF 文件。


## 非功能需求

1. **兼容性**
    - 支持主流浏览器（Chrome、Firefox、Edge、Safari）。

2. **响应式设计**
    - 页面在 PC 和移动端均能良好展示。

3. **性能**
    - 页面加载速度快，模板替换与生成过程无明显延迟。

4. **安全性**
    - 前端对输入内容做基础校验，防止脚本注入。

## 技术栈

- **前端框架**: Next.js 14 (App Router)
- **语言**: TypeScript
- **样式**: TailwindCSS
- **模板处理**: 原生 JS + DOM 操作 (用于替换模板.html 中的占位符)
- **导出功能**: html2canvas + jsPDF (用于导出 PDF)
- **二维码生成**: qrcode.js (可选)

## 页面结构

1. **信息输入区**
    - 表单区域，包含所有需要填写的车票信息字段。

2. **车票预览区**
    - 展示基于模板生成的车票预览。

3. **操作按钮区**
    - “生成车票”、“打印车票”、“导出为 PDF”等操作按钮。

## 模板替换逻辑

1. 加载 `模板.html` 文件，模板内各字段以占位符形式存在（如 `{name}`、`{id_number}` 等）。
2. 用户输入表单信息后，前端脚本将用户输入内容与模板占位符一一对应替换。
3. 替换完成后，将生成的 HTML 渲染于预览区。

## 打印导出要求

1. **打印**
    - 只打印车票预览区域，排除页面其他元素。
    - 打印样式需与实际车票效果一致。

2. **导出 PDF**
    - 可将车票预览区内容导出为 PDF 文件。
    - PDF 文件排版与页面预览一致。

## A4 排版要求

- 单张车票尺寸为 **86mm × 54mm**（含圆角半径约 3mm），可附加 2mm 出血。
- 在 A4 (210mm × 297mm) 纸张上进行排版，默认竖排，保证打印时为实际尺寸。
- 推荐排版方式：2 列 × 5 行（共 10 张车票）。
- 保证各车票间留 2-4mm 裁切间距，避免裁剪困难。
- 打印时需禁用浏览器的页眉页脚，缩放比例设置为 100%，以确保物理尺寸精确。
- 需提供不同排版模式选择（例如：3 张大票 / 6 张中票 / 10 张小票）。